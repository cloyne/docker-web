server {
    listen 80;
    server_name cloyne.net;
    access_log /var/log/nginx/cloyne.net_access.log;

    # We want to resolve container IPs dynamically, so we have to
    # configure resolver and use a variable to make Nginx resolving
    # it again and again and not only at start (so that it works if
    # containers change their IPs)
    resolver 172.17.42.1 valid=5s;
    resolver_timeout 5s;

    location / {
        return 404;
    }

    location /phppgadmin/ {
        set $phppgadmin phppgadmin.phppgadmin.server2.cloyne.net;
        proxy_pass http://$phppgadmin;
    }
}
